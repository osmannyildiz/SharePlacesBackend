{"version":3,"sources":["contexts/authContext.js","components/ui/Spinner.js","components/ui/Backdrop.js","components/nav/NavLinks.js","components/nav/Drawer.js","components/nav/HeaderNav.js","components/nav/Header.js","hooks/useAuth.js","App.js","index.js"],"names":["AuthContext","createContext","userId","token","login","logout","isLoggedIn","Spinner","props","className","asOverlay","Backdrop","ReactDOM","createPortal","onClick","document","getElementById","NavLinks","authContext","useContext","to","exact","Drawer","content","CSSTransition","in","isOpen","classNames","timeout","mountOnEnter","unmountOnExit","handleCloseDrawer","HeaderNav","Header","useState","drawerIsOpen","setDrawerIsOpen","closeDrawer","Fragment","logoutTimeoutId","useAuth","setUserId","setToken","tokenExpiry","setTokenExpiry","useCallback","autoLoggingIn","localStorage","setItem","JSON","stringify","now","Date","newTokenExpiry","getTime","toISOString","getItem","removeItem","useEffect","authData","parse","storedTokenExpiry","remainingTimeMs","setTimeout","clearTimeout","AddPlace","React","lazy","Authenticate","EditPlace","UserPlaces","Users","App","routes","path","Provider","value","fallback","render"],"mappings":"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","file":"static/js/main.3574463b.chunk.js","sourcesContent":["import { createContext } from \"react\";\n\nconst AuthContext = createContext({\n\tuserId: null,\n\ttoken: null,\n\tlogin: (userId, token) => {},\n\tlogout: () => {},\n\tisLoggedIn: false,\n});\n\nexport default AuthContext;\n","import React from \"react\";\nimport \"./Spinner.css\";\n\nexport default function Spinner(props) {\n\treturn (\n\t\t<div className={`${props.asOverlay && \"spinner__overlay\"}`}>\n\t\t\t<div className=\"spinner-dual-ring\"></div>\n\t\t</div>\n\t);\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./Backdrop.css\";\n\nexport default function Backdrop(props) {\n\treturn ReactDOM.createPortal(\n\t\t<div className=\"backdrop\" onClick={props.onClick}></div>,\n\t\tdocument.getElementById(\"backdrop-portal\")\n\t);\n}\n","import React, { useContext } from \"react\";\nimport { NavLink } from \"react-router-dom\";\nimport AuthContext from \"../../contexts/authContext\";\nimport \"./NavLinks.css\";\n\nexport default function NavLinks() {\n\tconst authContext = useContext(AuthContext);\n\n\treturn (\n\t\t<ul className=\"nav-links\">\n\t\t\t<li>\n\t\t\t\t<NavLink className=\"nav-link\" to=\"/\" exact>\n\t\t\t\t\tALL USERS\n\t\t\t\t</NavLink>\n\t\t\t</li>\n\t\t\t{!authContext.isLoggedIn && (\n\t\t\t\t<li>\n\t\t\t\t\t<NavLink className=\"nav-link\" to=\"/auth\">\n\t\t\t\t\t\tAUTHENTICATE\n\t\t\t\t\t</NavLink>\n\t\t\t\t</li>\n\t\t\t)}\n\t\t\t{authContext.isLoggedIn && (\n\t\t\t\t<li>\n\t\t\t\t\t<NavLink\n\t\t\t\t\t\tclassName=\"nav-link\"\n\t\t\t\t\t\tto={`/users/${authContext.userId}/places`}\n\t\t\t\t\t>\n\t\t\t\t\t\tMY PLACES\n\t\t\t\t\t</NavLink>\n\t\t\t\t</li>\n\t\t\t)}\n\t\t\t{authContext.isLoggedIn && (\n\t\t\t\t<li>\n\t\t\t\t\t<NavLink className=\"nav-link\" to=\"/places/add\">\n\t\t\t\t\t\tADD PLACE\n\t\t\t\t\t</NavLink>\n\t\t\t\t</li>\n\t\t\t)}\n\t\t\t{authContext.isLoggedIn && (\n\t\t\t\t<li>\n\t\t\t\t\t<button className=\"nav-link\" onClick={authContext.logout}>\n\t\t\t\t\t\tLOGOUT\n\t\t\t\t\t</button>\n\t\t\t\t</li>\n\t\t\t)}\n\t\t</ul>\n\t);\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { CSSTransition } from \"react-transition-group\";\nimport \"./Drawer.css\";\nimport NavLinks from \"./NavLinks\";\n\nexport default function Drawer(props) {\n\tconst content = (\n\t\t<CSSTransition\n\t\t\tin={props.isOpen}\n\t\t\tclassNames=\"slide-in-left\"\n\t\t\ttimeout={200}\n\t\t\tmountOnEnter\n\t\t\tunmountOnExit\n\t\t>\n\t\t\t<aside className=\"drawer\">\n\t\t\t\t<nav className=\"drawer-nav\" onClick={props.handleCloseDrawer}>\n\t\t\t\t\t<NavLinks />\n\t\t\t\t</nav>\n\t\t\t</aside>\n\t\t</CSSTransition>\n\t);\n\treturn ReactDOM.createPortal(\n\t\tcontent,\n\t\tdocument.getElementById(\"drawer-portal\")\n\t);\n}\n","import React from \"react\";\nimport \"./HeaderNav.css\";\nimport NavLinks from \"./NavLinks\";\n\nexport default function HeaderNav() {\n\treturn (\n\t\t<nav className=\"header-nav\">\n\t\t\t<NavLinks />\n\t\t</nav>\n\t);\n}\n","import React, { useState } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport Backdrop from \"../ui/Backdrop\";\nimport Drawer from \"./Drawer\";\nimport \"./Header.css\";\nimport HeaderNav from \"./HeaderNav\";\n\nexport default function Header() {\n\tconst [drawerIsOpen, setDrawerIsOpen] = useState(false);\n\n\tfunction openDrawer() {\n\t\tsetDrawerIsOpen(true);\n\t}\n\n\tfunction closeDrawer() {\n\t\tsetDrawerIsOpen(false);\n\t}\n\n\treturn (\n\t\t<React.Fragment>\n\t\t\t{drawerIsOpen && <Backdrop onClick={closeDrawer} />}\n\t\t\t<Drawer isOpen={drawerIsOpen} handleCloseDrawer={closeDrawer} />\n\n\t\t\t<header className=\"header\">\n\t\t\t\t<button className=\"header__menu-btn\" onClick={openDrawer}>\n\t\t\t\t\t<span />\n\t\t\t\t\t<span />\n\t\t\t\t\t<span />\n\t\t\t\t</button>\n\t\t\t\t<h1 className=\"header__title\">\n\t\t\t\t\t<Link to=\"/\">YourPlaces</Link>\n\t\t\t\t</h1>\n\t\t\t\t<HeaderNav />\n\t\t\t</header>\n\t\t</React.Fragment>\n\t);\n}\n","import { useCallback, useEffect, useState } from \"react\";\n\nlet logoutTimeoutId;\n\nconst useAuth = () => {\n\tconst [userId, setUserId] = useState(null);\n\tconst [token, setToken] = useState(null);\n\tconst [tokenExpiry, setTokenExpiry] = useState(null);\n\n\tconst login = useCallback((userId, token, autoLoggingIn = false) => {\n\t\tsetUserId(userId);\n\t\tsetToken(token);\n\t\tlocalStorage.setItem(\"authData\", JSON.stringify({ userId, token }));\n\t\tif (!autoLoggingIn) {\n\t\t\tconst now = new Date();\n\t\t\tconst newTokenExpiry = new Date(now.getTime() + 1000 * 60 * 60);\n\t\t\tlocalStorage.setItem(\"tokenExpiry\", newTokenExpiry.toISOString());\n\t\t}\n\t\tsetTokenExpiry(new Date(localStorage.getItem(\"tokenExpiry\")));\n\t}, []);\n\n\tconst logout = useCallback(() => {\n\t\tsetUserId(null);\n\t\tsetToken(null);\n\t\tlocalStorage.removeItem(\"authData\");\n\t\tsetTokenExpiry(null);\n\t\tlocalStorage.removeItem(\"tokenExpiry\");\n\t}, []);\n\n\tuseEffect(() => {\n\t\tconst authData = JSON.parse(localStorage.getItem(\"authData\"));\n\t\tconst storedTokenExpiry = localStorage.getItem(\"tokenExpiry\");\n\t\tconst now = new Date();\n\n\t\tif (authData && authData.userId) {\n\t\t\tif (storedTokenExpiry && new Date(storedTokenExpiry) > now) {\n\t\t\t\tlogin(authData.userId, authData.token, true);\n\t\t\t} else {\n\t\t\t\tlogout();\n\t\t\t}\n\t\t}\n\t}, [login, logout]);\n\n\tuseEffect(() => {\n\t\tif (tokenExpiry) {\n\t\t\tconst now = new Date();\n\t\t\tconst remainingTimeMs = tokenExpiry.getTime() - now.getTime();\n\t\t\tlogoutTimeoutId = setTimeout(logout, remainingTimeMs);\n\t\t} else {\n\t\t\tclearTimeout(logoutTimeoutId);\n\t\t}\n\t}, [tokenExpiry, logout]);\n\n\treturn { userId, token, login, logout };\n};\n\nexport default useAuth;\n","import React, { Suspense } from \"react\";\nimport {\n\tBrowserRouter as Router,\n\tRedirect,\n\tRoute,\n\tSwitch,\n} from \"react-router-dom\";\nimport Header from \"./components/nav/Header\";\nimport Spinner from \"./components/ui/Spinner\";\nimport AuthContext from \"./contexts/authContext\";\nimport useAuth from \"./hooks/useAuth\";\nimport \"./styles/form.css\";\n\n// Code splitting (lazy load pages)\nconst AddPlace = React.lazy(() => import(\"./pages/AddPlace\"));\nconst Authenticate = React.lazy(() => import(\"./pages/Authenticate\"));\nconst EditPlace = React.lazy(() => import(\"./pages/EditPlace\"));\nconst UserPlaces = React.lazy(() => import(\"./pages/UserPlaces\"));\nconst Users = React.lazy(() => import(\"./pages/Users\"));\n\nfunction App() {\n\tconst { userId, token, login, logout } = useAuth();\n\n\tlet routes;\n\tif (userId) {\n\t\troutes = (\n\t\t\t<Switch>\n\t\t\t\t<Route path=\"/\" exact>\n\t\t\t\t\t<Users />\n\t\t\t\t</Route>\n\t\t\t\t<Route path=\"/users/:userId/places\" exact>\n\t\t\t\t\t<UserPlaces />\n\t\t\t\t</Route>\n\t\t\t\t<Route path=\"/places/add\" exact>\n\t\t\t\t\t<AddPlace />\n\t\t\t\t</Route>\n\t\t\t\t<Route path=\"/places/:placeId/edit\" exact>\n\t\t\t\t\t<EditPlace />\n\t\t\t\t</Route>\n\t\t\t\t<Redirect to=\"/\" />\n\t\t\t</Switch>\n\t\t);\n\t} else {\n\t\troutes = (\n\t\t\t<Switch>\n\t\t\t\t<Route path=\"/\" exact>\n\t\t\t\t\t<Users />\n\t\t\t\t</Route>\n\t\t\t\t<Route path=\"/auth\" exact>\n\t\t\t\t\t<Authenticate />\n\t\t\t\t</Route>\n\t\t\t\t<Route path=\"/users/:userId/places\" exact>\n\t\t\t\t\t<UserPlaces />\n\t\t\t\t</Route>\n\t\t\t\t<Redirect to=\"/auth\" />\n\t\t\t</Switch>\n\t\t);\n\t}\n\n\treturn (\n\t\t<AuthContext.Provider\n\t\t\tvalue={{ userId, token, login, logout, isLoggedIn: !!userId }}\n\t\t>\n\t\t\t<Router>\n\t\t\t\t<Header />\n\t\t\t\t<main>\n\t\t\t\t\t<Suspense\n\t\t\t\t\t\tfallback={\n\t\t\t\t\t\t\t<div className=\"center\">\n\t\t\t\t\t\t\t\t<Spinner />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t}\n\t\t\t\t\t>\n\t\t\t\t\t\t{routes}\n\t\t\t\t\t</Suspense>\n\t\t\t\t</main>\n\t\t\t</Router>\n\t\t</AuthContext.Provider>\n\t);\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}