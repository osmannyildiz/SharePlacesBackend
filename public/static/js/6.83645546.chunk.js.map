{"version":3,"sources":["components/form/ImagePicker.js","pages/Authenticate.js"],"names":["ImagePicker","props","useState","imageFile","setImageFile","previewUrl","setPreviewUrl","isValid","setIsValid","isTouched","setIsTouched","filePickerRef","useRef","useEffect","fileReader","FileReader","onload","result","readAsDataURL","className","type","accept","name","style","display","ref","onChange","event","_imageFile","_isValid","target","files","length","onInput","center","previewWidth","width","src","alt","onClick","current","click","Authenticate","authContext","useContext","AuthContext","isLoginMode","setIsLoginMode","useForm","formState","inputHandler","setFormData","useHttpClient","sendRequest","isLoading","error","clearError","preventDefault","process","JSON","stringify","email","inputs","value","password","respData","login","data","userId","token","console","formData","FormData","append","image","undefined","Fragment","onCancel","asOverlay","onSubmit","label","validators","Validators","required","minLength","disabled","marginTop","inverse"],"mappings":"iLAIe,SAASA,EAAYC,GACnC,MAAkCC,mBAAS,MAA3C,mBAAOC,EAAP,KAAkBC,EAAlB,KACA,EAAoCF,mBAAS,MAA7C,mBAAOG,EAAP,KAAmBC,EAAnB,KACA,EAA8BJ,oBAAS,GAAvC,mBAAOK,EAAP,KAAgBC,EAAhB,KACA,EAAkCN,oBAAS,GAA3C,mBAAOO,EAAP,KAAkBC,EAAlB,KACMC,EAAgBC,mBA4BtB,OAzBAC,qBAAU,WACT,GAAKV,EAAL,CAEA,IAAMW,EAAa,IAAIC,WACvBD,EAAWE,OAAS,WACnBV,EAAcQ,EAAWG,SAE1BH,EAAWI,cAAcf,MACvB,CAACA,IAkBH,yBAAKgB,UAAU,gBACd,2BACCC,KAAK,OACLC,OAAO,kBACPC,KAAMrB,EAAMqB,KACZC,MAAO,CAAEC,QAAS,QAClBC,IAAKd,EACLe,SAvBH,SAA0BC,GACzB,IAAIC,EAAazB,EACb0B,EAAWtB,EACXoB,EAAMG,OAAOC,OAAuC,IAA9BJ,EAAMG,OAAOC,MAAMC,QAC5CJ,EAAaD,EAAMG,OAAOC,MAAM,GAChCF,GAAW,GAEXA,GAAW,EAEZzB,EAAawB,GACbpB,EAAWqB,GACXnB,GAAa,GACbT,EAAMgC,QAAQhC,EAAMqB,KAAMM,EAAYC,MAarC,yBACCV,UAAS,uBAAkBlB,EAAMiC,QAAU,SAAlC,aACP3B,GAAWE,GAAa,0BAG1B,yBACCU,UAAU,wBACVI,MAAOtB,EAAMkC,aAAe,CAAEC,MAAOnC,EAAMkC,cAAiB,IAE3D9B,EACA,yBAAKgC,IAAKhC,EAAYiC,IAAI,YAE1B,2BACC,2DAIH,kBAAC,IAAD,CAAQlB,KAAK,SAASmB,QAAS,kBAAM5B,EAAc6B,QAAQC,UAA3D,kB,4hNCpDW,SAASC,IACvB,IAAMC,EAAcC,qBAAWC,KAE/B,EAAsC3C,oBAAS,GAA/C,mBAAO4C,EAAP,KAAoBC,EAApB,KACA,EAA+CC,YAAQ,CAAC,QAAS,aAAjE,mBAAOC,EAAP,KAAkBC,EAAlB,KAAgCC,EAAhC,KACA,EAAoDC,cAApD,mBAAOC,EAAP,KAAoBC,EAApB,KAA+BC,EAA/B,KAAsCC,EAAtC,KALsC,4CAuCtC,WAA6B7B,GAA7B,8EACCA,EAAM8B,kBACFX,EAFL,0CAI0BO,EACtBK,gEACA,OACA,CACC,eAAgB,oBAEjBC,KAAKC,UAAU,CACdC,MAAOZ,EAAUa,OAAOD,MAAME,MAC9BC,SAAUf,EAAUa,OAAOE,SAASD,SAZzC,OAISE,EAJT,OAeGtB,EAAYuB,MAAMD,EAASE,KAAKC,OAAQH,EAASE,KAAKE,OAfzD,gDAiBGC,QAAQf,MAAR,MAjBH,uCAoBQgB,EAAW,IAAIC,UACZC,OAAO,OAAQxB,EAAUa,OAAOxC,KAAKyC,OAC9CQ,EAASE,OAAO,QAASxB,EAAUa,OAAOD,MAAME,OAChDQ,EAASE,OAAO,WAAYxB,EAAUa,OAAOE,SAASD,OACtDQ,EAASE,OAAO,QAASxB,EAAUa,OAAOY,MAAMX,OAxBlD,oBA0B0BV,EACtBK,mEACA,YACAiB,EACAJ,GA9BJ,QA0BSN,EA1BT,OAgCGtB,EAAYuB,MAAMD,EAASE,KAAKC,OAAQH,EAASE,KAAKE,OAhCzD,mDAkCGC,QAAQf,MAAR,MAlCH,kEAvCsC,sBA8EtC,OACC,kBAAC,IAAMqB,SAAP,KACC,kBAAC,IAAD,CAAYrB,MAAOA,EAAOsB,SAAUrB,IACnCF,GAAa,kBAAC,IAAD,CAASwB,WAAS,IAChC,0BAAM3D,UAAU,iBAAiB4D,SAlFG,6CAmFnC,4BAAKjC,EAAc,QAAU,YAC7B,8BACEA,GACD,kBAAC,IAAD,CACC1B,KAAK,OACLE,KAAK,OACL0D,MAAM,YACNC,WAAY,CAACC,IAAWC,YACxBlD,QAASiB,IAGX,kBAAC,IAAD,CACC9B,KAAK,QACLE,KAAK,QACL0D,MAAM,SACNC,WAAY,CAACC,IAAWrB,SACxB5B,QAASiB,IAEV,kBAAC,IAAD,CACC9B,KAAK,WACLE,KAAK,WACL0D,MAAM,WACNC,WAAY,CAACC,IAAWE,UAAU,IAClCnD,QAASiB,KAERJ,GACD,kBAAC,IAAD,CAAaxB,KAAK,QAAQY,QAAM,EAACD,QAASiB,IAE3C,kBAAC,IAAD,CACC9B,KAAK,SACLiE,UAAWpC,EAAU1C,QACrBgB,MAAO,CAAE+D,UAAW,WAEnBxC,EAAc,QAAU,YAE1B,6BACA,kBAAC,IAAD,CACC1B,KAAK,SACLmE,SAAO,EACPpE,UAAU,aACVoB,QApHe,WACbO,EAaJK,EAAY,2BAEPF,EAAUa,QAFJ,IAGTxC,KAAM,CACLyC,MAAO,GACPxD,SAAS,GAEVmE,MAAO,CACNX,MAAO,KACPxD,SAAS,MAGX,GAvBD4C,EAAY,2BAEPF,EAAUa,QAFJ,IAGTxC,UAAMqD,EACND,WAAOC,IAER1B,EAAUa,OAAOD,MAAMtD,SAAW0C,EAAUa,OAAOE,SAASzD,SAoB9DwC,GAAe,SAACD,GAAD,OAAkBA,OAmF/B,aAMYA,EAAc,WAAa","file":"static/js/6.83645546.chunk.js","sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport Button from \"./Button\";\nimport \"./ImagePicker.css\";\n\nexport default function ImagePicker(props) {\n\tconst [imageFile, setImageFile] = useState(null);\n\tconst [previewUrl, setPreviewUrl] = useState(null);\n\tconst [isValid, setIsValid] = useState(false);\n\tconst [isTouched, setIsTouched] = useState(false);\n\tconst filePickerRef = useRef();\n\n\t// Generate preview\n\tuseEffect(() => {\n\t\tif (!imageFile) return;\n\n\t\tconst fileReader = new FileReader();\n\t\tfileReader.onload = () => {\n\t\t\tsetPreviewUrl(fileReader.result);\n\t\t};\n\t\tfileReader.readAsDataURL(imageFile);\n\t}, [imageFile]);\n\n\tfunction pickImageHandler(event) {\n\t\tlet _imageFile = imageFile;\n\t\tlet _isValid = isValid;\n\t\tif (event.target.files && event.target.files.length === 1) {\n\t\t\t_imageFile = event.target.files[0];\n\t\t\t_isValid = true;\n\t\t} else {\n\t\t\t_isValid = false;\n\t\t}\n\t\tsetImageFile(_imageFile);\n\t\tsetIsValid(_isValid);\n\t\tsetIsTouched(true);\n\t\tprops.onInput(props.name, _imageFile, _isValid);\n\t}\n\n\treturn (\n\t\t<div className=\"form-control\">\n\t\t\t<input\n\t\t\t\ttype=\"file\"\n\t\t\t\taccept=\".jpg,.jpeg,.png\"\n\t\t\t\tname={props.name}\n\t\t\t\tstyle={{ display: \"none\" }}\n\t\t\t\tref={filePickerRef}\n\t\t\t\tonChange={pickImageHandler}\n\t\t\t/>\n\t\t\t<div\n\t\t\t\tclassName={`image-picker ${props.center && \"center\"} ${\n\t\t\t\t\t!isValid && isTouched && \"image-picker--invalid\"\n\t\t\t\t}`}\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"image-picker__preview\"\n\t\t\t\t\tstyle={props.previewWidth ? { width: props.previewWidth } : {}}\n\t\t\t\t>\n\t\t\t\t\t{previewUrl ? (\n\t\t\t\t\t\t<img src={previewUrl} alt=\"Preview\" />\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t<strong>Please pick an image.</strong>\n\t\t\t\t\t\t</p>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t\t<Button type=\"button\" onClick={() => filePickerRef.current.click()}>\n\t\t\t\t\tPICK IMAGE\n\t\t\t\t</Button>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n","import React, { useContext, useState } from \"react\";\nimport Button from \"../components/form/Button\";\nimport ImagePicker from \"../components/form/ImagePicker\";\nimport Input from \"../components/form/Input\";\nimport ErrorModal from \"../components/ui/ErrorModal\";\nimport Spinner from \"../components/ui/Spinner\";\nimport AuthContext from \"../contexts/authContext\";\nimport useForm from \"../hooks/useForm\";\nimport useHttpClient from \"../hooks/useHttpClient\";\nimport { Validators } from \"../utils/validation\";\nimport \"./Authenticate.css\";\n\nexport default function Authenticate() {\n\tconst authContext = useContext(AuthContext);\n\n\tconst [isLoginMode, setIsLoginMode] = useState(true);\n\tconst [formState, inputHandler, setFormData] = useForm([\"email\", \"password\"]);\n\tconst [sendRequest, isLoading, error, clearError] = useHttpClient();\n\n\tconst switchMode = () => {\n\t\tif (!isLoginMode) {\n\t\t\t// Switching to login mode\n\t\t\tsetFormData(\n\t\t\t\t{\n\t\t\t\t\t...formState.inputs,\n\t\t\t\t\tname: undefined,\n\t\t\t\t\timage: undefined,\n\t\t\t\t},\n\t\t\t\tformState.inputs.email.isValid && formState.inputs.password.isValid\n\t\t\t);\n\t\t} else {\n\t\t\t// Switching to register mode\n\t\t\t// (Actually it still works if we omit this whole else block)\n\t\t\tsetFormData(\n\t\t\t\t{\n\t\t\t\t\t...formState.inputs,\n\t\t\t\t\tname: {\n\t\t\t\t\t\tvalue: \"\",\n\t\t\t\t\t\tisValid: false,\n\t\t\t\t\t},\n\t\t\t\t\timage: {\n\t\t\t\t\t\tvalue: null,\n\t\t\t\t\t\tisValid: false,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tfalse\n\t\t\t);\n\t\t}\n\t\tsetIsLoginMode((isLoginMode) => !isLoginMode);\n\t};\n\n\tasync function submitHandler(event) {\n\t\tevent.preventDefault();\n\t\tif (isLoginMode) {\n\t\t\ttry {\n\t\t\t\tconst respData = await sendRequest(\n\t\t\t\t\tprocess.env.REACT_APP_BACKEND_API_URL + \"/users/login\",\n\t\t\t\t\t\"POST\",\n\t\t\t\t\t{\n\t\t\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\t\t},\n\t\t\t\t\tJSON.stringify({\n\t\t\t\t\t\temail: formState.inputs.email.value,\n\t\t\t\t\t\tpassword: formState.inputs.password.value,\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t\tauthContext.login(respData.data.userId, respData.data.token);\n\t\t\t} catch (err) {\n\t\t\t\tconsole.error(err);\n\t\t\t}\n\t\t} else {\n\t\t\tconst formData = new FormData();\n\t\t\tformData.append(\"name\", formState.inputs.name.value);\n\t\t\tformData.append(\"email\", formState.inputs.email.value);\n\t\t\tformData.append(\"password\", formState.inputs.password.value);\n\t\t\tformData.append(\"image\", formState.inputs.image.value);\n\t\t\ttry {\n\t\t\t\tconst respData = await sendRequest(\n\t\t\t\t\tprocess.env.REACT_APP_BACKEND_API_URL + \"/users/register\",\n\t\t\t\t\t\"POST\",\n\t\t\t\t\tundefined,\n\t\t\t\t\tformData\n\t\t\t\t);\n\t\t\t\tauthContext.login(respData.data.userId, respData.data.token);\n\t\t\t} catch (err) {\n\t\t\t\tconsole.error(err);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn (\n\t\t<React.Fragment>\n\t\t\t<ErrorModal error={error} onCancel={clearError} />\n\t\t\t{isLoading && <Spinner asOverlay />}\n\t\t\t<form className=\"form auth-form\" onSubmit={submitHandler}>\n\t\t\t\t<h2>{isLoginMode ? \"Login\" : \"Register\"}</h2>\n\t\t\t\t<hr />\n\t\t\t\t{!isLoginMode && (\n\t\t\t\t\t<Input\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tname=\"name\"\n\t\t\t\t\t\tlabel=\"Your Name\"\n\t\t\t\t\t\tvalidators={[Validators.required()]}\n\t\t\t\t\t\tonInput={inputHandler}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t\t<Input\n\t\t\t\t\ttype=\"email\"\n\t\t\t\t\tname=\"email\"\n\t\t\t\t\tlabel=\"E-mail\"\n\t\t\t\t\tvalidators={[Validators.email()]}\n\t\t\t\t\tonInput={inputHandler}\n\t\t\t\t/>\n\t\t\t\t<Input\n\t\t\t\t\ttype=\"password\"\n\t\t\t\t\tname=\"password\"\n\t\t\t\t\tlabel=\"Password\"\n\t\t\t\t\tvalidators={[Validators.minLength(6)]}\n\t\t\t\t\tonInput={inputHandler}\n\t\t\t\t/>\n\t\t\t\t{!isLoginMode && (\n\t\t\t\t\t<ImagePicker name=\"image\" center onInput={inputHandler} />\n\t\t\t\t)}\n\t\t\t\t<Button\n\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\tdisabled={!formState.isValid}\n\t\t\t\t\tstyle={{ marginTop: \"1.5rem\" }}\n\t\t\t\t>\n\t\t\t\t\t{isLoginMode ? \"LOGIN\" : \"REGISTER\"}\n\t\t\t\t</Button>\n\t\t\t\t<br />\n\t\t\t\t<Button\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tinverse\n\t\t\t\t\tclassName=\"switch-btn\"\n\t\t\t\t\tonClick={switchMode}\n\t\t\t\t>\n\t\t\t\t\tSWITCH TO {isLoginMode ? \"REGISTER\" : \"LOGIN\"}\n\t\t\t\t</Button>\n\t\t\t</form>\n\t\t</React.Fragment>\n\t);\n}\n"],"sourceRoot":""}