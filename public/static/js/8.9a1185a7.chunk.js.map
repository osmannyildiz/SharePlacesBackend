{"version":3,"sources":["pages/AddPlace.js","components/form/ImagePicker.js"],"names":["AddPlace","authContext","useContext","AuthContext","history","useHistory","useForm","formState","inputHandler","useHttpClient","sendRequest","isLoading","error","clearError","event","preventDefault","formData","FormData","append","inputs","title","value","description","address","image","process","Authorization","token","push","console","Fragment","onCancel","asOverlay","className","onSubmit","type","name","label","validators","Validators","required","onInput","as","minLength","previewWidth","disabled","isValid","style","marginTop","ImagePicker","props","useState","imageFile","setImageFile","previewUrl","setPreviewUrl","setIsValid","isTouched","setIsTouched","filePickerRef","useRef","useEffect","fileReader","FileReader","onload","result","readAsDataURL","accept","display","ref","onChange","_imageFile","_isValid","target","files","length","center","width","src","alt","onClick","current","click"],"mappings":"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","file":"static/js/8.9a1185a7.chunk.js","sourcesContent":["import React, { useContext } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport Button from \"../components/form/Button\";\nimport ImagePicker from \"../components/form/ImagePicker\";\nimport Input from \"../components/form/Input\";\nimport ErrorModal from \"../components/ui/ErrorModal\";\nimport Spinner from \"../components/ui/Spinner\";\nimport AuthContext from \"../contexts/authContext\";\nimport useForm from \"../hooks/useForm\";\nimport useHttpClient from \"../hooks/useHttpClient\";\nimport \"../styles/form.css\";\nimport { Validators } from \"../utils/validation\";\n\nexport default function AddPlace() {\n\tconst authContext = useContext(AuthContext);\n\tconst history = useHistory();\n\tconst [formState, inputHandler] = useForm([\n\t\t\"title\",\n\t\t\"description\",\n\t\t\"address\",\n\t\t\"image\",\n\t]);\n\tconst [sendRequest, isLoading, error, clearError] = useHttpClient();\n\n\tasync function submitHandler(event) {\n\t\tevent.preventDefault();\n\t\tconst formData = new FormData();\n\t\tformData.append(\"title\", formState.inputs.title.value);\n\t\tformData.append(\"description\", formState.inputs.description.value);\n\t\tformData.append(\"address\", formState.inputs.address.value);\n\t\tformData.append(\"image\", formState.inputs.image.value);\n\t\ttry {\n\t\t\tawait sendRequest(\n\t\t\t\tprocess.env.REACT_APP_BACKEND_API_URL + \"/places\",\n\t\t\t\t\"POST\",\n\t\t\t\t{\n\t\t\t\t\tAuthorization: \"Bearer \" + authContext.token,\n\t\t\t\t},\n\t\t\t\tformData\n\t\t\t);\n\t\t\thistory.push(\"/\");\n\t\t} catch (err) {\n\t\t\tconsole.error(err);\n\t\t}\n\t}\n\n\treturn (\n\t\t<React.Fragment>\n\t\t\t<ErrorModal error={error} onCancel={clearError} />\n\t\t\t{isLoading && <Spinner asOverlay />}\n\t\t\t<form className=\"form place-add-form\" onSubmit={submitHandler}>\n\t\t\t\t<Input\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tname=\"title\"\n\t\t\t\t\tlabel=\"Title\"\n\t\t\t\t\tvalidators={[Validators.required()]}\n\t\t\t\t\tonInput={inputHandler}\n\t\t\t\t/>\n\t\t\t\t<Input\n\t\t\t\t\tas=\"textarea\"\n\t\t\t\t\tname=\"description\"\n\t\t\t\t\tlabel=\"Description\"\n\t\t\t\t\tvalidators={[Validators.minLength(5)]}\n\t\t\t\t\tonInput={inputHandler}\n\t\t\t\t/>\n\t\t\t\t<Input\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tname=\"address\"\n\t\t\t\t\tlabel=\"Address\"\n\t\t\t\t\tvalidators={[Validators.required()]}\n\t\t\t\t\tonInput={inputHandler}\n\t\t\t\t/>\n\t\t\t\t<ImagePicker name=\"image\" previewWidth=\"20rem\" onInput={inputHandler} />\n\t\t\t\t<Button\n\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\tdisabled={!formState.isValid}\n\t\t\t\t\tstyle={{ marginTop: \"1.5rem\" }}\n\t\t\t\t>\n\t\t\t\t\tADD PLACE\n\t\t\t\t</Button>\n\t\t\t</form>\n\t\t</React.Fragment>\n\t);\n}\n","import React, { useEffect, useRef, useState } from \"react\";\nimport Button from \"./Button\";\nimport \"./ImagePicker.css\";\n\nexport default function ImagePicker(props) {\n\tconst [imageFile, setImageFile] = useState(null);\n\tconst [previewUrl, setPreviewUrl] = useState(null);\n\tconst [isValid, setIsValid] = useState(false);\n\tconst [isTouched, setIsTouched] = useState(false);\n\tconst filePickerRef = useRef();\n\n\t// Generate preview\n\tuseEffect(() => {\n\t\tif (!imageFile) return;\n\n\t\tconst fileReader = new FileReader();\n\t\tfileReader.onload = () => {\n\t\t\tsetPreviewUrl(fileReader.result);\n\t\t};\n\t\tfileReader.readAsDataURL(imageFile);\n\t}, [imageFile]);\n\n\tfunction pickImageHandler(event) {\n\t\tlet _imageFile = imageFile;\n\t\tlet _isValid = isValid;\n\t\tif (event.target.files && event.target.files.length === 1) {\n\t\t\t_imageFile = event.target.files[0];\n\t\t\t_isValid = true;\n\t\t} else {\n\t\t\t_isValid = false;\n\t\t}\n\t\tsetImageFile(_imageFile);\n\t\tsetIsValid(_isValid);\n\t\tsetIsTouched(true);\n\t\tprops.onInput(props.name, _imageFile, _isValid);\n\t}\n\n\treturn (\n\t\t<div className=\"form-control\">\n\t\t\t<input\n\t\t\t\ttype=\"file\"\n\t\t\t\taccept=\".jpg,.jpeg,.png\"\n\t\t\t\tname={props.name}\n\t\t\t\tstyle={{ display: \"none\" }}\n\t\t\t\tref={filePickerRef}\n\t\t\t\tonChange={pickImageHandler}\n\t\t\t/>\n\t\t\t<div\n\t\t\t\tclassName={`image-picker ${props.center && \"center\"} ${\n\t\t\t\t\t!isValid && isTouched && \"image-picker--invalid\"\n\t\t\t\t}`}\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"image-picker__preview\"\n\t\t\t\t\tstyle={props.previewWidth ? { width: props.previewWidth } : {}}\n\t\t\t\t>\n\t\t\t\t\t{previewUrl ? (\n\t\t\t\t\t\t<img src={previewUrl} alt=\"Preview\" />\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t<strong>Please pick an image.</strong>\n\t\t\t\t\t\t</p>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t\t<Button type=\"button\" onClick={() => filePickerRef.current.click()}>\n\t\t\t\t\tPICK IMAGE\n\t\t\t\t</Button>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n"],"sourceRoot":""}